This is almost the same as http://railscasts.com/episodes/250-authentication-from-scratch with minor changes to support
strong parameters in Rails 4.
